$(function(){$(".J_add_sort").click(function(){return $.jBox.show({width:500,title:"添加分销商排名",content:_.template($("#tpl_agent_add").html()),btnOK:{onBtnClick:function(n){$.jBox.close(n);var t=n.find("input[name='user_name']").val(),o=parseFloat(n.find("input[name='commission']").val());$.ajax({url:"/User/agent_add?v="+Math.round(100*Math.random()),type:"post",dataType:"json",data:{user_name:t,commission:o},beforeSend:function(){$.jBox.showloading()},success:function(n){1==n.status?(HYD.hint("success","恭喜您，添加成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，添加失败："+n.msg),$.jBox.hideloading()}})}}}),!1}),$(".j-edit").click(function(){var n=$(this),t=n.data("id");defaults={sort:n.data("sort"),name:n.data("name")};var o=_.template($("#tpl_agent_edit").html(),defaults),a=$(o),e=a.find("input[name='user_name']"),i=a.find("input[name='commission']");return $.jBox.show({width:500,title:"编辑分销商排名",content:a,btnOK:{onBtnClick:function(o){$.jBox.close(o);var a=e.val(),s=parseFloat(i.val());$.ajax({url:"/User/agent_edit?v="+Math.round(100*Math.random()),type:"post",dataType:"json",data:{commission_rank_id:t,user_name:a,commission:s},beforeSend:function(){$.jBox.showloading()},success:function(t){1==t.status?(HYD.hint("success","恭喜您，编辑成功！"),n.data("sort",s),n.data("name",a),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，编辑失败："+t.msg),$.jBox.hideloading()}})}}}),!1}),$(".j-del").click(function(){var n=$(this),t=n.data("id");return $.jBox.show({title:"提示",content:"删除后将不可恢复，确认删除吗？",btnOK:{onBtnClick:function(n){$.jBox.close(n),$.ajax({url:"/User/agent_del?v="+Math.round(100*Math.random()),type:"post",dataType:"json",data:{id:t},beforeSend:function(){$.jBox.showloading()},success:function(n){1==n.status?(HYD.hint("success","恭喜您，删除成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，删除失败："+n.msg),$.jBox.hideloading()}})}}}),!1}),$(".j-delAll").click(function(){var n=[],t=$(".table-ckbs:checked");return t.each(function(){n.push($(this).data("id"))}),n.length?($.jBox.show({title:"提示",content:"删除后将不可恢复，确认删除吗？",btnOK:{onBtnClick:function(t){$.jBox.close(t),$.ajax({url:"/User/agent_delAll?v="+Math.round(100*Math.random()),type:"post",dataType:"json",data:{ids:n},beforeSend:function(){$.jBox.showloading()},success:function(n){1==n.status?(HYD.hint("success","恭喜您，删除成功！"),setTimeout(function(){window.location.reload()},1e3)):HYD.hint("danger","对不起，删除失败："+n.msg),$.jBox.hideloading()}})}}}),!1):void HYD.hint("danger","对不起，请选择要删除的分销商！")})});